local ESPEnabled = false
local Running = false
-- üî∑ T·∫°o ESP Highlight
local function createOutlineESP(model, outlineColor, fillColor)
    local h = Instance.new("Highlight")
    h.Adornee = model
    h.FillTransparency = 0.75
    h.FillColor = fillColor
    h.OutlineColor = outlineColor
    h.OutlineTransparency = 0
    h.Parent = model
end
-- üî∑ ESP cho nh√≥m
local function createOutlineESPForGroup(group, outlineColor, fillColor)
    for _, obj in pairs(group:GetChildren()) do
        if obj:FindFirstChildOfClass("Humanoid") and obj:FindFirstChild("HumanoidRootPart") then
            createOutlineESP(obj, outlineColor, fillColor)
        end
    end
end
-- üî∑ ESP cho Generator
local function highlightGenerators()
    local f = workspace:FindFirstChild("Map")
    f = f and f:FindFirstChild("Ingame")
    f = f and f:FindFirstChild("Map")
    if f then
        for _, obj in pairs(f:GetChildren()) do
            if obj:IsA("Model") and obj.Name == "Generator" then
                createOutlineESP(obj, Color3.new(1, 1, 0), Color3.new(1, 1, 0.5))
            end
        end
    end
end
-- üîÑ V√≤ng l·∫∑p ESP
local function updateESP()
    while ESPEnabled do
        for _, obj in pairs(workspace:GetChildren()) do
            if obj:IsA("Model") then
                for _, c in pairs(obj:GetChildren()) do
                    if c:IsA("Highlight") then c:Destroy() end
                end
            end
        end

        local killers = workspace.Players:FindFirstChild("Killers")
        if killers then createOutlineESPForGroup(killers, Color3.new(1, 0, 0), Color3.new(1, 0.5, 0.5)) end

        local survivors = workspace.Players:FindFirstChild("Survivors")
        if survivors then createOutlineESPForGroup(survivors, Color3.new(0, 1, 0), Color3.new(0.5, 1, 0.5)) end

        highlightGenerators()
        task.wait(5)
    end
end
-- üîß Rayfield UI
local Rayfield = loadstring(game:HttpGet("https://sirius.menu/rayfield"))()
local win = Rayfield:CreateWindow({
    Name = "[NOLIüé≠]ForSaken Scriptüî•",
    Theme = "AmberGlow",
    ToggleUIKeybind = "K",
    ConfigurationSaving = {Enabled = true, FileName = "Skibidisaken"},
    KeySystem = true,
    KeySettings = {Title = "Get Keyüîë", Key = {"Chubby"}, SaveKey = true, FileName = "Key"}
})
-- üè° Tab ch√≠nh (Home)
local home = win:CreateTab("üè° Home")
home:CreateToggle({
    Name = "INF Stamina",
    CurrentValue = false,
    Flag = "Toggle1",
    Callback = function(Value)
        Running = Value
        local m = require(game.ReplicatedStorage.Systems.Character.Game.Sprinting)
        m.StaminaLossDisabled = Value
        if Value then
            task.spawn(function()
                while Running do
                    task.wait(0.1)
                    m.Stamina = m.MaxStamina
                    m.StaminaChanged:Fire()
                end
            end)
        end
    end,
})
home:CreateToggle({
    Name = "ESP (Survivor Killer Generator)",
    CurrentValue = false,
    Flag = "Toggle2",
    Callback = function(Value)
        ESPEnabled = Value
        if Value then
            task.spawn(updateESP)
        else
            for _, obj in pairs(workspace:GetDescendants()) do
                if obj:IsA("Highlight") then obj:Destroy() end
            end
        end
    end,
})
-- üåê Tab ph·ª• (Misc)
local misc = win:CreateTab("üåê Misc")
misc:CreateButton({
    Name = "NoFog",
    Callback = function()
        for _, v in pairs(game.Lighting:GetChildren()) do
            if v:IsA("Sky") then v:Destroy() end
        end

        local s = Instance.new("Sky")
        s.SkyboxBk = "rbxassetid://401664839"
        s.SkyboxDn = "rbxassetid://401664889"
        s.SkyboxFt = "rbxassetid://401664831"
        s.SkyboxLf = "rbxassetid://401664808"
        s.SkyboxRt = "rbxassetid://401664845"
        s.SkyboxUp = "rbxassetid://401664874"
        s.Parent = game.Lighting

        game.Lighting.ChildAdded:Connect(function(child)
            if child:IsA("Sky") then task.wait(0.1) child:Destroy() end
        end)

        game.Lighting.FogEnd = 100000
        game.Lighting.FogStart = 0
        game.Lighting.ClockTime = 14
        game.Lighting.Brightness = 2
        game.Lighting.GlobalShadows = false
    end,
})
misc:CreateButton({
    Name = "FixLag(Little)",
    Callback = function()
        for _, v in pairs(workspace:GetDescendants()) do
            if v:IsA("ParticleEmitter") or v:IsA("Trail") or v:IsA("Smoke") or v:IsA("Sparkles") or v:IsA("Beam") or v:IsA("Fire") then
                v.Enabled = false
            elseif v:IsA("Decal") or v:IsA("Texture") then
                v.Transparency = math.clamp(v.Transparency + 0.5, 0, 1)
            elseif v:IsA("MeshPart") or v:IsA("Part") then
                v.Material = Enum.Material.Plastic
                v.Reflectance = 0
            end
        end
    end,
})
misc:CreateButton({
    Name = "FixLag(Extreme)",
    Callback = function()
        -- üö´ T·∫Øt to√†n b·ªô hi·ªáu ·ª©ng th·ªã gi√°c
        for _, v in pairs(workspace:GetDescendants()) do
            if v:IsA("ParticleEmitter") or v:IsA("Trail") or v:IsA("Smoke") or v:IsA("Sparkles")
            or v:IsA("Explosion") or v:IsA("Fire") or v:IsA("Beam") or v:IsA("Light") then
                v.Enabled = false
            elseif v:IsA("Decal") or v:IsA("Texture") then
                v.Transparency = 1 -- ·∫©n ho√†n to√†n
            elseif v:IsA("MeshPart") or v:IsA("Part") then
                v.Material = Enum.Material.SmoothPlastic
                v.Reflectance = 0
                v.CastShadow = false
            end
        end
        -- üåå L√†m s·∫°ch Lighting m√¥i tr∆∞·ªùng
        local lighting = game.Lighting
        lighting.FogEnd = 100000
        lighting.FogStart = 0
        lighting.ClockTime = 12
        lighting.Brightness = 1
        lighting.GlobalShadows = false
        lighting.Ambient = Color3.new(1, 1, 1)
        lighting.OutdoorAmbient = Color3.new(1, 1, 1)
        -- ‚òÅÔ∏è X√≥a to√†n b·ªô Sky v√† hi·ªáu ·ª©ng ph·ª•
        for _, v in pairs(lighting:GetChildren()) do
            if v:IsA("Sky") or v:IsA("BloomEffect") or v:IsA("ColorCorrectionEffect") or v:IsA("DepthOfFieldEffect") then
                v:Destroy()
            end
        end
        -- üí® X√≥a c√°c hi·ªáu ·ª©ng tr√™n Camera
        local camera = workspace.CurrentCamera
        for _, v in pairs(camera:GetChildren()) do
            if v:IsA("PostEffect") then v:Destroy() end
        end
    end,
})
